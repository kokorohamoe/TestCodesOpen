

import cv2
import numpy
import matplotlib.pyplot
import numba
import numba as nb
import numba.cuda
from numba import cuda
#https://qiita.com/hoto17296/items/d7f3bd3df0a51bf78bf9

images = []
for i in [2,13]:
	file     = ('images/image%03d.png' % i )
	file_img = cv2.imread(file)
	images.append(file_img)

@numba.cuda.jit
def to_gray_color(img_in, img_out):
    x, y = cuda.grid(2)
    if x < img_in.shape[0] and y < img_in.shape[1]:
        img_out[x, y,0] =   0.1140*img_in[x, y,0]+0.5870*img_in[x, y,1]+0.2989*img_in[x, y,2]
        img_out[x, y,1] =   0.1140*img_in[x, y,0]+0.5870*img_in[x, y,1]+0.2989*img_in[x, y,2]
        img_out[x, y,2] =   0.1140*img_in[x, y,0]+0.5870*img_in[x, y,1]+0.2989*img_in[x, y,2]

gray = numpy.zeros(images[0].shape, dtype=numpy.uint8)
to_gray_color[images[0].shape, 1](images[0], gray)

matplotlib.pyplot.clf()
matplotlib.pyplot.imshow(gray)
matplotlib.pyplot.show()

