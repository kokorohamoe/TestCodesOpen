#
#

import pandas 
targets_data = pandas.read_csv("y_classified.csv")

C_BGR   = 0
C_YUV   = 1
C_Y     = 2

import cv2
import numpy
images = [ [],[],[] ]
for i in range(100):
    file = ('images/image%03d.png' % i )
    img = cv2.imread(file)
    images[C_BGR].append(img)
    img_yuv = cv2.cvtColor(img, cv2.COLOR_BGR2YUV)
    img_yuv_split = cv2.split(img_yuv)
    images[C_YUV].append(img_yuv)
    images[C_Y].append(img_yuv_split[0])

images_data =  [ [],[],[] ]
for c in range(3):
	images_data[c] = numpy.empty((100,len(images[c][0].ravel())),int)
	for i in range(100):
		images_data[c][i] = numpy.array ([images[c][i].ravel()])


import sklearn
import sklearn.model_selection
pakapaka = sklearn.model_selection.train_test_split(images_data, targets_data['Kirishima'], random_state=0)
pakapaka_yuv = sklearn.model_selection.train_test_split(images_data_yuv, targets_data['Kirishima'], random_state=0)

print( len(pakapaka) )
print( len(pakapaka_yuv) )

X_TRAIN = 0
X_TEST  = 1
Y_TRAIN = 2
Y_TEST  = 3

print(pakapaka[X_TRAIN].shape)
print(pakapaka[X_TEST].shape)
print(pakapaka[Y_TRAIN].shape)
print(pakapaka[Y_TEST].shape)
print(pakapaka_yuv[X_TRAIN].shape)
print(pakapaka_yuv[X_TEST].shape)
print(pakapaka_yuv[Y_TRAIN].shape)
print(pakapaka_yuv[Y_TEST].shape)

#knn = KNeighborsClassifier(n_neighbors=1)
#knn.fit(X_train, y_train)

